# ğŸ” Figma æ’ä»¶è°ƒè¯•æŒ‡å— - SkinnedMesh & è´´å›¾é—®é¢˜

## å¿«é€Ÿå¼€å§‹

### 1. é‡æ–°åŠ è½½æ’ä»¶

1. åœ¨ Figma ä¸­ï¼Œå…³é—­å½“å‰æ’ä»¶
2. é‡æ–°æ‰“å¼€æ’ä»¶ï¼ˆç¡®ä¿ä½¿ç”¨æœ€æ–°æ„å»ºçš„ç‰ˆæœ¬ï¼‰
3. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼š
   - **Windows**: `Ctrl + Shift + I` æˆ– `F12`
   - **Mac**: `Cmd + Option + I`

### 2. æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—

åœ¨æ§åˆ¶å°ä¸­æŸ¥æ‰¾ä»¥ä¸‹å…³é”®æ—¥å¿—ï¼š

#### ğŸ“Š æ•°æ®åŠ è½½æ—¥å¿—

```
ğŸ® View3D - æ•°æ®çŠ¶æ€: {
  vectorsCount: X,
  foldSequenceLength: X,
  hPanelId: "...",
  hasDrivenMap: true/false,
  hasPanelNameMap: true/false
}
```

**æ£€æŸ¥ç‚¹ï¼š**
- `vectorsCount` åº”è¯¥ > 0
- `hPanelId` åº”è¯¥æœ‰å€¼ï¼ˆå¦‚æœè®¾ç½®äº† H é¢æ¿ï¼‰

---

#### ğŸ¨ æ¸²æŸ“æ¨¡å¼æ—¥å¿—

```
ğŸ¨ View3D - æ¸²æŸ“æ¨¡å¼: SkinnedMesh
```

**æ£€æŸ¥ç‚¹ï¼š**
- åº”è¯¥æ˜¾ç¤º `SkinnedMesh` è€Œä¸æ˜¯ `Recursive`
- å¦‚æœæ˜¾ç¤º `Recursive`ï¼Œç‚¹å‡»ç•Œé¢ä¸Šçš„ "Skinned" æŒ‰é’®åˆ‡æ¢

---

#### ğŸŒ³ æ ‘ç»“æ„æ—¥å¿—

```
ğŸŒ³ View3D - æ ‘ç»“æ„: {
  rootId: "...",
  vectorsCount: X,
  firstVector: { id, name, x, y, width, height }
}
```

**æ£€æŸ¥ç‚¹ï¼š**
- `rootId` åº”è¯¥æœ‰å€¼
- `vectorsCount` åº”è¯¥ > 0
- `firstVector` åº”è¯¥æœ‰å®Œæ•´çš„åæ ‡æ•°æ®

---

#### ğŸ¦´ SkinnedMeshView æ¸²æŸ“æ—¥å¿—

```
ğŸ¦´ SkinnedMeshView - æ¸²æŸ“çŠ¶æ€: {
  hasPanelTree: true/false,
  vectorsCount: X,
  rootId: "...",
  foldProgress: 0-1,
  thickness: 2,
  cornerRadius: 2
}
```

**æ£€æŸ¥ç‚¹ï¼š**
- `hasPanelTree` åº”è¯¥æ˜¯ `true`
- å¦‚æœæ˜¯ `false`ï¼Œè¯´æ˜é¢æ¿æ ‘æ„å»ºå¤±è´¥

---

#### ğŸ¨ çº¹ç†å›¾é›†æ—¥å¿—

```
ğŸ¨ SkinnedMeshBridge: çº¹ç†å›¾é›†æ„å»ºå®Œæˆ {
  texture: Texture {...},
  regions: Map {...}
}
```

**æ£€æŸ¥ç‚¹ï¼š**
- åº”è¯¥çœ‹åˆ°è¿™æ¡æ—¥å¿—
- å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜çº¹ç†å›¾é›†æ„å»ºå¤±è´¥

---

#### ğŸ›ï¸ PBR è´´å›¾æ—¥å¿—

```
ğŸ¨ SkinnedMeshBridge - pbrMaps æ›´æ–°: {
  hasMetalnessMap: true/false,
  hasRoughnessMap: true/false,
  hasClearcoatMap: true/false
}
```

**æ£€æŸ¥ç‚¹ï¼š**
- å¦‚æœæœ‰å·¥è‰ºå›¾å±‚ï¼ˆçƒ«é‡‘ã€çƒ«é“¶ã€UVï¼‰ï¼Œè¿™äº›åº”è¯¥æ˜¯ `true`
- å¦‚æœæ²¡æœ‰å·¥è‰ºå›¾å±‚ï¼Œè¿™äº›ä¼šæ˜¯ `false`ï¼ˆè¿™æ˜¯æ­£å¸¸çš„ï¼‰

---

#### ğŸ”§ å‡ ä½•ä½“æ„å»ºæ—¥å¿—

```
ğŸ”§ å‡ ä½•ä½“æ„å»ºå®Œæˆ: X é¡¶ç‚¹
```

**æ£€æŸ¥ç‚¹ï¼š**
- é¡¶ç‚¹æ•°åº”è¯¥ > 0
- å¦‚æœæ²¡æœ‰è¿™æ¡æ—¥å¿—ï¼Œè¯´æ˜å‡ ä½•ä½“æ„å»ºå¤±è´¥

---

#### ğŸ”— éª¨éª¼ç»‘å®šæ—¥å¿—

```
ğŸ”— éª¨éª¼ç»‘å®šå®Œæˆï¼Œå·²æ›´æ–°ä¸–ç•ŒçŸ©é˜µå¹¶è®¡ç®—é€†çŸ©é˜µ
```

**æ£€æŸ¥ç‚¹ï¼š**
- åº”è¯¥çœ‹åˆ°è¿™æ¡æ—¥å¿—
- å¦‚æœæ²¡æœ‰ï¼Œè¯´æ˜éª¨éª¼ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥

---

## å¸¸è§é—®é¢˜è¯Šæ–­

### âŒ é—®é¢˜ 1: çœ‹ä¸åˆ° 3D è§†å›¾

**å¯èƒ½åŸå› ï¼š**
1. æ²¡æœ‰é€‰æ‹©é¢æ¿æ•°æ®
2. `vectorsCount` ä¸º 0
3. WebGL åˆå§‹åŒ–å¤±è´¥

**è§£å†³æ–¹æ³•ï¼š**
1. åœ¨ Figma ä¸­é€‰æ‹©ä¸€äº›çŸ¢é‡å›¾å±‚
2. ç‚¹å‡» "Mark as Clipmask" æŒ‰é’®
3. æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰ WebGL é”™è¯¯

---

### âŒ é—®é¢˜ 2: æ˜¾ç¤º Recursive æ¨¡å¼è€Œä¸æ˜¯ SkinnedMesh

**å¯èƒ½åŸå› ï¼š**
- æ¨¡å¼åˆ‡æ¢æŒ‰é’®è¢«ç‚¹å‡»äº†

**è§£å†³æ–¹æ³•ï¼š**
1. åœ¨ 3D è§†å›¾åº•éƒ¨æ‰¾åˆ° "Skinned" / "Recursive" æŒ‰é’®
2. ç‚¹å‡» "Skinned" æŒ‰é’®
3. æŸ¥çœ‹æ§åˆ¶å°ç¡®è®¤ï¼š`ğŸ¨ View3D - æ¸²æŸ“æ¨¡å¼: SkinnedMesh`

---

### âŒ é—®é¢˜ 3: SkinnedMesh æ˜¾ç¤ºä½†æ²¡æœ‰è´´å›¾

**å¯èƒ½åŸå› ï¼š**
1. PNG é¢„è§ˆæ•°æ®æœªåŠ è½½
2. çº¹ç†å›¾é›†æ„å»ºå¤±è´¥
3. æè´¨æœªæ­£ç¡®åº”ç”¨

**è§£å†³æ–¹æ³•ï¼š**

**æ­¥éª¤ 1: æ£€æŸ¥ PNG æ•°æ®**
```
ğŸ” SkinnedMeshBridge: è¾“å…¥é¢æ¿æ•°æ®æ£€æŸ¥
  Panel 0: XXX (id) - pngPreview: YES (XXXX chars)
```
- å¦‚æœæ˜¾ç¤º `NO`ï¼Œè¯´æ˜éœ€è¦é‡æ–°ç”Ÿæˆé¢„è§ˆ

**æ­¥éª¤ 2: æ£€æŸ¥çº¹ç†å›¾é›†**
```
ğŸ¨ SkinnedMeshBridge: çº¹ç†å›¾é›†æ„å»ºå®Œæˆ
```
- å¦‚æœæ²¡æœ‰è¿™æ¡æ—¥å¿—ï¼Œæ£€æŸ¥æ˜¯å¦æœ‰é”™è¯¯

**æ­¥éª¤ 3: æ£€æŸ¥æè´¨**
- åœ¨æ§åˆ¶å°è¾“å…¥ï¼š`console.log(document.querySelector('canvas'))`
- æ£€æŸ¥æ˜¯å¦æœ‰ Canvas å…ƒç´ 

---

### âŒ é—®é¢˜ 4: PBR æ•ˆæœï¼ˆçƒ«é‡‘ã€çƒ«é“¶ï¼‰ä¸æ˜¾ç¤º

**å¯èƒ½åŸå› ï¼š**
1. æ²¡æœ‰æ·»åŠ å·¥è‰ºå›¾å±‚
2. PBR Worker æœªç”Ÿæˆè´´å›¾
3. è´´å›¾æœªæ­£ç¡®ä¼ é€’ç»™æè´¨

**è§£å†³æ–¹æ³•ï¼š**

**æ­¥éª¤ 1: æ£€æŸ¥å·¥è‰ºå›¾å±‚**
```
ğŸ›ï¸ SkinnedMeshBridge - PBR çŠ¶æ€: {
  hasPbrMaps: true/false,
  craftLayersCount: X,
  pbrConfig: {...}
}
```
- `craftLayersCount` åº”è¯¥ > 0

**æ­¥éª¤ 2: æ£€æŸ¥ PBR Worker**
```
âœ… usePBRMapsFromCraftLayers - PBR maps generated (Worker)
```
æˆ–
```
ğŸ¨ PBR maps cache hit
```

**æ­¥éª¤ 3: æ£€æŸ¥è´´å›¾çŠ¶æ€**
```
ğŸ¨ SkinnedMeshBridge - pbrMaps æ›´æ–°: {
  hasMetalnessMap: true,
  hasRoughnessMap: true,
  hasClearcoatMap: true
}
```

---

## æ€§èƒ½ç›‘æ§

### æŸ¥çœ‹ PBR ç”Ÿæˆæ—¶é—´

åœ¨æ§åˆ¶å°æŸ¥æ‰¾ï¼š
```
â±ï¸ PBR Generation: XX.XXms
```

### æŸ¥çœ‹ç¼“å­˜å‘½ä¸­

```
ğŸ¨ PBR maps cache hit
```
- ç¬¬ä¸€æ¬¡ç”Ÿæˆä¼šæ¯”è¾ƒæ…¢ï¼ˆ100-300msï¼‰
- ç¼“å­˜å‘½ä¸­åº”è¯¥ < 5ms

---

## æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

### 1. åŸºç¡€æ¸²æŸ“æµ‹è¯•

1. åœ¨ Figma ä¸­åˆ›å»º 3-5 ä¸ªçŸ©å½¢
2. é€‰ä¸­å®ƒä»¬
3. ç‚¹å‡» "Mark as Clipmask"
4. åˆ‡æ¢åˆ° 3D è§†å›¾
5. æ£€æŸ¥æ˜¯å¦æ˜¾ç¤º SkinnedMesh

**é¢„æœŸæ—¥å¿—ï¼š**
```
ğŸ® View3D - æ•°æ®çŠ¶æ€: { vectorsCount: 3-5, ... }
ğŸ¨ View3D - æ¸²æŸ“æ¨¡å¼: SkinnedMesh
ğŸ¦´ SkinnedMeshView - æ¸²æŸ“çŠ¶æ€: { hasPanelTree: true, ... }
ğŸ”§ å‡ ä½•ä½“æ„å»ºå®Œæˆ: XX é¡¶ç‚¹
ğŸ”— éª¨éª¼ç»‘å®šå®Œæˆ
```

---

### 2. è´´å›¾æµ‹è¯•

1. ç¡®ä¿çŸ©å½¢æœ‰å¡«å……é¢œè‰²æˆ–å›¾ç‰‡
2. ç­‰å¾… PNG é¢„è§ˆç”Ÿæˆ
3. åˆ‡æ¢åˆ° 3D è§†å›¾

**é¢„æœŸæ—¥å¿—ï¼š**
```
ğŸ” SkinnedMeshBridge: è¾“å…¥é¢æ¿æ•°æ®æ£€æŸ¥
  Panel 0: ... - pngPreview: YES (XXXX chars)
ğŸ¨ SkinnedMeshBridge: çº¹ç†å›¾é›†æ„å»ºå®Œæˆ
```

---

### 3. PBR å·¥è‰ºæµ‹è¯•

1. æ·»åŠ å·¥è‰ºå›¾å±‚ï¼ˆçƒ«é‡‘ã€çƒ«é“¶ã€UVï¼‰
2. è°ƒæ•´å·¥è‰ºå‚æ•°
3. åˆ‡æ¢åˆ° 3D è§†å›¾

**é¢„æœŸæ—¥å¿—ï¼š**
```
ğŸ›ï¸ SkinnedMeshBridge - pbrConfig æ›´æ–°: { ... }
âœ… usePBRMapsFromCraftLayers - PBR maps generated (Worker)
ğŸ¨ SkinnedMeshBridge - pbrMaps æ›´æ–°: {
  hasMetalnessMap: true,
  hasRoughnessMap: true,
  hasClearcoatMap: true
}
```

---

### 4. æŠ˜å åŠ¨ç”»æµ‹è¯•

1. æ‹–åŠ¨æŠ˜å è¿›åº¦æ»‘å—ï¼ˆ0% - 100%ï¼‰
2. è§‚å¯Ÿ 3D æ¨¡å‹æ˜¯å¦å¹³æ»‘æŠ˜å 

**é¢„æœŸï¼š**
- åº”è¯¥çœ‹åˆ°å¹³æ»‘çš„æŠ˜å åŠ¨ç”»
- æ²¡æœ‰å¡é¡¿æˆ–é—ªçƒ
- éª¨éª¼å…³èŠ‚å¤„åº”è¯¥å¹³æ»‘è¿‡æ¸¡

---

## é”™è¯¯æ’æŸ¥æ¸…å•

### âœ… æ•°æ®å±‚
- [ ] `vectorsCount > 0`
- [ ] `rootId` æœ‰å€¼
- [ ] `hasDrivenMap: true`

### âœ… æ¸²æŸ“å±‚
- [ ] æ¸²æŸ“æ¨¡å¼æ˜¯ `SkinnedMesh`
- [ ] `hasPanelTree: true`
- [ ] çœ‹åˆ° "å‡ ä½•ä½“æ„å»ºå®Œæˆ" æ—¥å¿—
- [ ] çœ‹åˆ° "éª¨éª¼ç»‘å®šå®Œæˆ" æ—¥å¿—

### âœ… è´´å›¾å±‚
- [ ] PNG é¢„è§ˆæ•°æ®å­˜åœ¨
- [ ] çœ‹åˆ° "çº¹ç†å›¾é›†æ„å»ºå®Œæˆ" æ—¥å¿—
- [ ] Canvas å…ƒç´ å­˜åœ¨

### âœ… PBR å±‚ï¼ˆå¯é€‰ï¼‰
- [ ] `craftLayersCount > 0`
- [ ] çœ‹åˆ° "PBR maps generated" æ—¥å¿—
- [ ] `hasPbrMaps: true`

---

## éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ— æ³•è§£å†³é—®é¢˜ï¼Œè¯·æä¾›ï¼š

1. **å®Œæ•´çš„æ§åˆ¶å°æ—¥å¿—**ï¼ˆä»æ’ä»¶æ‰“å¼€åˆ°é—®é¢˜å‡ºç°ï¼‰
2. **æˆªå›¾**ï¼ˆæ˜¾ç¤ºå½“å‰çŠ¶æ€ï¼‰
3. **æ“ä½œæ­¥éª¤**ï¼ˆå¦‚ä½•å¤ç°é—®é¢˜ï¼‰
4. **Figma æ–‡ä»¶ä¿¡æ¯**ï¼ˆå›¾å±‚æ•°é‡ã€ç±»å‹ç­‰ï¼‰

å°†è¿™äº›ä¿¡æ¯å‘é€ç»™å¼€å‘å›¢é˜Ÿè¿›è¡Œè¿›ä¸€æ­¥è¯Šæ–­ã€‚
